# [WIP] mercurius-auth

![CI workflow](https://github.com/mercurius-js/auth/workflows/CI%20workflow/badge.svg)

**WIP**

Mercurius Auth is a plugin for [Mercurius](https://mercurius.dev) that adds configurable Authentication and Authorization support.

Features:

- 

## Install

```bash
npm i fastify mercurius mercurius-auth
```

## Example

WIP

## Benchmarks

### Normal GraphQL Server Mode | Without Auth

Last run: `2021-04-16`

```text
┌─────────┬──────┬──────┬───────┬───────┬─────────┬─────────┬────────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%   │ Avg     │ Stdev   │ Max    │
├─────────┼──────┼──────┼───────┼───────┼─────────┼─────────┼────────┤
│ Latency │ 0 ms │ 8 ms │ 17 ms │ 22 ms │ 8.24 ms │ 3.99 ms │ 118 ms │
└─────────┴──────┴──────┴───────┴───────┴─────────┴─────────┴────────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg     │ Stdev   │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Req/Sec   │ 5611    │ 5611    │ 10967   │ 11111   │ 10423.8 │ 1608.95 │ 5609    │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Bytes/Sec │ 2.95 MB │ 2.95 MB │ 5.77 MB │ 5.84 MB │ 5.48 MB │ 846 kB  │ 2.95 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┘

Req/Bytes counts sampled once per second.
114k requests in 10.03s, 59.9 MB read
```

### Normal GraphQL Server Mode | With Auth

Last run: `2021-04-16`

```text
┌─────────┬──────┬───────┬───────┬───────┬──────────┬─────────┬────────┐
│ Stat    │ 2.5% │ 50%   │ 97.5% │ 99%   │ Avg      │ Stdev   │ Max    │
├─────────┼──────┼───────┼───────┼───────┼──────────┼─────────┼────────┤
│ Latency │ 0 ms │ 13 ms │ 27 ms │ 31 ms │ 13.19 ms │ 6.09 ms │ 124 ms │
└─────────┴──────┴───────┴───────┴───────┴──────────┴─────────┴────────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg     │ Stdev   │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Req/Sec   │ 3581    │ 3581    │ 6995    │ 7155    │ 6641.5  │ 1041.13 │ 3580    │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Bytes/Sec │ 1.88 MB │ 1.88 MB │ 3.68 MB │ 3.76 MB │ 3.49 MB │ 548 kB  │ 1.88 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┘

Req/Bytes counts sampled once per second.
73k requests in 10.05s, 38.6 MB read
```

### Gateway GraphQL Server Mode | Without Auth

Last run: `2021-04-16`

```text
┌─────────┬───────┬───────┬───────┬────────┬──────────┬──────────┬────────┐
│ Stat    │ 2.5%  │ 50%   │ 97.5% │ 99%    │ Avg      │ Stdev    │ Max    │
├─────────┼───────┼───────┼───────┼────────┼──────────┼──────────┼────────┤
│ Latency │ 39 ms │ 43 ms │ 80 ms │ 121 ms │ 47.05 ms │ 13.52 ms │ 214 ms │
└─────────┴───────┴───────┴───────┴────────┴──────────┴──────────┴────────┘
┌───────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%    │ 97.5%  │ Avg    │ Stdev  │ Min    │
├───────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤
│ Req/Sec   │ 1014   │ 1014   │ 2279   │ 2321   │ 2099.6 │ 392.63 │ 1014   │
├───────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤
│ Bytes/Sec │ 355 kB │ 355 kB │ 798 kB │ 812 kB │ 735 kB │ 137 kB │ 355 kB │
└───────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┘

Req/Bytes counts sampled once per second.
21k requests in 10.05s, 7.35 MB read
```

### Gateway GraphQL Server Mode | With Auth

Last run: `2021-04-16`

```text
┌─────────┬───────┬───────┬───────┬────────┬──────────┬──────────┬────────┐
│ Stat    │ 2.5%  │ 50%   │ 97.5% │ 99%    │ Avg      │ Stdev    │ Max    │
├─────────┼───────┼───────┼───────┼────────┼──────────┼──────────┼────────┤
│ Latency │ 44 ms │ 49 ms │ 84 ms │ 130 ms │ 52.77 ms │ 14.86 ms │ 231 ms │
└─────────┴───────┴───────┴───────┴────────┴──────────┴──────────┴────────┘
┌───────────┬────────┬────────┬────────┬────────┬────────┬────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%    │ 97.5%  │ Avg    │ Stdev  │ Min    │
├───────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤
│ Req/Sec   │ 998    │ 998    │ 2004   │ 2097   │ 1872.1 │ 334.37 │ 998    │
├───────────┼────────┼────────┼────────┼────────┼────────┼────────┼────────┤
│ Bytes/Sec │ 349 kB │ 349 kB │ 701 kB │ 734 kB │ 655 kB │ 117 kB │ 349 kB │
└───────────┴────────┴────────┴────────┴────────┴────────┴────────┴────────┘

Req/Bytes counts sampled once per second.
19k requests in 10.02s, 6.55 MB read
```

## License

MIT
